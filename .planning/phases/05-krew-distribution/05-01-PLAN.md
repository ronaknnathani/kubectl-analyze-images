---
phase: 05-krew-distribution
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - LICENSE
  - plugins/analyze-images.yaml
  - SECURITY.md
  - CONTRIBUTING.md
autonomous: true

must_haves:
  truths:
    - "Apache-2.0 LICENSE file exists at repo root"
    - "Krew manifest describes the plugin with correct platform URIs and selectors"
    - "SECURITY.md provides vulnerability reporting instructions"
    - "CONTRIBUTING.md provides development and contribution guidelines"
  artifacts:
    - path: "LICENSE"
      provides: "Apache-2.0 license text"
      contains: "Apache License, Version 2.0"
    - path: "plugins/analyze-images.yaml"
      provides: "Krew plugin manifest"
      contains: "apiVersion: krew.googlecontainertools.github.com/v1alpha2"
    - path: "SECURITY.md"
      provides: "Security policy for vulnerability reporting"
      contains: "Security"
    - path: "CONTRIBUTING.md"
      provides: "Contribution guidelines"
      contains: "Contributing"
  key_links:
    - from: "plugins/analyze-images.yaml"
      to: ".goreleaser.yaml"
      via: "Archive naming convention must match"
      pattern: "kubectl-analyze-images_.*_{{.OS}}_{{.Arch}}"
---

<objective>
Create LICENSE, krew plugin manifest, SECURITY.md, and CONTRIBUTING.md for open-source distribution.

Purpose: These files are required for a professional open-source release and krew plugin submission. The krew manifest is the key artifact that enables `kubectl krew install` distribution.
Output: Four new files at repo root (LICENSE, SECURITY.md, CONTRIBUTING.md) and plugins/analyze-images.yaml (krew manifest).
</objective>

<execution_context>
@/Users/rnathani/.claude/get-shit-done/workflows/execute-plan.md
@/Users/rnathani/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.goreleaser.yaml
@cmd/kubectl-analyze-images/main.go
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create LICENSE and krew plugin manifest</name>
  <files>LICENSE, plugins/analyze-images.yaml</files>
  <action>
Create two files:

1. **LICENSE** (repo root): Full Apache License, Version 2.0 text.
   - Use the standard Apache-2.0 license text from https://www.apache.org/licenses/LICENSE-2.0.txt
   - Copyright line: "Copyright 2026 Ronak Nathani"
   - This is the standard license for kubectl plugins (same as kubectl itself)

2. **plugins/analyze-images.yaml** (krew manifest):
   - `apiVersion: krew.googlecontainertools.github.com/v1alpha2`
   - `kind: Plugin`
   - `metadata.name: analyze-images`
   - `spec.version: v1.0.0`
   - `spec.homepage: https://github.com/ronaknnathani/kubectl-analyze-images`
   - `spec.shortDescription: "Analyze container image sizes across Kubernetes clusters"`
   - `spec.description`: Multi-line description covering what the plugin does -- analyzes container image sizes from node status data, generates histogram visualizations and size reports, supports namespace/label filtering, table and JSON output formats.
   - `spec.caveats`: Note that the plugin requires read access to nodes and pods in the cluster.
   - `spec.platforms`: Six entries matching .goreleaser.yaml targets:
     - linux/amd64, linux/arm64, darwin/amd64, darwin/arm64, windows/amd64, windows/arm64
   - For each platform entry:
     - `selector.matchLabels.os`: the GOOS value (linux, darwin, windows)
     - `selector.matchLabels.arch`: the GOARCH value (amd64, arm64)
     - `uri`: `https://github.com/ronaknnathani/kubectl-analyze-images/releases/download/v1.0.0/kubectl-analyze-images_1.0.0_<os>_<arch>.tar.gz` (use `.zip` for windows)
     - `sha256`: Use placeholder `"REPLACE_WITH_ACTUAL_SHA256"` -- these get filled from real release artifacts
     - `bin`: `kubectl-analyze-images` (add `.exe` for windows)

   **CRITICAL**: The archive name pattern MUST match .goreleaser.yaml's `name_template`:
   `{{ .ProjectName }}_{{ .Version }}_{{ .Os }}_{{ .Arch }}` which produces names like
   `kubectl-analyze-images_1.0.0_linux_amd64.tar.gz`. Note: GoReleaser uses lowercase OS names
   (linux, darwin, windows) which matches krew's `matchLabels.os` values.
  </action>
  <verify>
  Run these checks:
  - `test -f LICENSE && head -1 LICENSE` shows Apache License header
  - `test -f plugins/analyze-images.yaml` confirms manifest exists
  - `grep -c "sha256" plugins/analyze-images.yaml` returns 6 (one per platform)
  - `grep "apiVersion: krew.googlecontainertools.github.com/v1alpha2" plugins/analyze-images.yaml` succeeds
  - `grep "analyze-images" plugins/analyze-images.yaml` confirms correct plugin name
  </verify>
  <done>
  LICENSE file contains full Apache-2.0 text. Krew manifest has correct apiVersion, 6 platform entries matching goreleaser archive naming, placeholder sha256 hashes, and correct binary names.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create SECURITY.md and CONTRIBUTING.md</name>
  <files>SECURITY.md, CONTRIBUTING.md</files>
  <action>
Create two files:

1. **SECURITY.md** (repo root): Standard security policy.
   - Title: "Security Policy"
   - Supported Versions section: Table showing v1.0.x as supported
   - Reporting a Vulnerability section: Instruct users to email security concerns privately rather than opening public issues. Use a GitHub issue with "security" label as the reporting mechanism (since this is a personal project without a dedicated security email). Mention expected response time of 7 days.
   - Scope: Clarify this is a read-only kubectl plugin that queries cluster data -- it does not modify cluster state, store credentials, or make external network calls beyond the Kubernetes API server.

2. **CONTRIBUTING.md** (repo root): Standard open-source contribution guidelines.
   - Title: "Contributing to kubectl-analyze-images"
   - Prerequisites section: Go 1.23+, kubectl, access to a Kubernetes cluster for testing
   - Development Setup section: git clone, make deps, make build, make test
   - Making Changes section: Fork, branch, make changes, add tests, run `make check` (runs test + lint), commit, push, open PR
   - Code Style section: Note that golangci-lint is configured (`.golangci.yml`), run `make lint` before submitting
   - Testing section: Run `make test` for unit tests, `make test-coverage` for coverage report, target >70% coverage for new code
   - Pull Request Guidelines: Clear description, include test coverage, one feature per PR, reference any related issues
   - License section: Note contributions are under Apache-2.0
  </action>
  <verify>
  Run these checks:
  - `test -f SECURITY.md && grep -q "Security Policy" SECURITY.md` succeeds
  - `test -f CONTRIBUTING.md && grep -q "Contributing" CONTRIBUTING.md` succeeds
  - `grep -q "Apache" CONTRIBUTING.md` confirms license reference
  - `grep -q "make test" CONTRIBUTING.md` confirms dev workflow documented
  </verify>
  <done>
  SECURITY.md has vulnerability reporting instructions and scope clarification. CONTRIBUTING.md has prerequisites, dev setup, code style, testing, and PR guidelines referencing the actual Makefile targets and tooling.
  </done>
</task>

</tasks>

<verification>
Final checks after all tasks:
1. `ls LICENSE SECURITY.md CONTRIBUTING.md plugins/analyze-images.yaml` -- all four files exist
2. `grep "Apache License" LICENSE` -- correct license
3. `grep "apiVersion" plugins/analyze-images.yaml` -- valid krew manifest structure
4. `grep -c "REPLACE_WITH_ACTUAL_SHA256" plugins/analyze-images.yaml` -- returns 6 (placeholder hashes for all platforms)
5. Verify archive names in manifest match goreleaser naming: `kubectl-analyze-images_1.0.0_<os>_<arch>.tar.gz`
</verification>

<success_criteria>
- LICENSE contains full Apache License 2.0 text
- plugins/analyze-images.yaml is a valid krew manifest with 6 platform entries
- Krew manifest URIs match goreleaser archive naming convention exactly
- SECURITY.md provides clear vulnerability reporting instructions
- CONTRIBUTING.md documents development workflow using actual Makefile targets
- All four files are well-structured and ready for v1.0.0 release
</success_criteria>

<output>
After completion, create `.planning/phases/05-krew-distribution/05-01-SUMMARY.md`
</output>
