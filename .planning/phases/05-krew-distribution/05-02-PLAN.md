---
phase: 05-krew-distribution
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - README.md
autonomous: true

must_haves:
  truths:
    - "README documents krew installation method"
    - "README documents manual binary installation method"
    - "README shows all available CLI flags with descriptions"
    - "README includes example output showing what the plugin produces"
    - "README includes release and verification instructions for maintainers"
  artifacts:
    - path: "README.md"
      provides: "Complete project documentation"
      contains: "kubectl krew install"
      min_lines: 150
  key_links:
    - from: "README.md"
      to: "plugins/analyze-images.yaml"
      via: "krew installation instructions reference manifest"
      pattern: "krew install"
    - from: "README.md"
      to: ".goreleaser.yaml"
      via: "Release instructions reference goreleaser"
      pattern: "goreleaser"
---

<objective>
Polish README.md with comprehensive documentation covering krew installation, manual installation, usage examples with all flags, example output, development setup, and release instructions.

Purpose: README is the primary entry point for users discovering the plugin. It must clearly explain what the plugin does, how to install it (via krew and manually), how to use it, and what output to expect. It also serves as the maintainer guide for releases.
Output: Fully rewritten README.md ready for v1.0.0 public release.
</objective>

<execution_context>
@/Users/rnathani/.claude/get-shit-done/workflows/execute-plan.md
@/Users/rnathani/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@cmd/kubectl-analyze-images/main.go
@Makefile
@README.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rewrite README.md with complete documentation</name>
  <files>README.md</files>
  <action>
Completely rewrite README.md with the following sections in this order:

**1. Title and Badges**
- `# kubectl-analyze-images`
- One-line description: "A kubectl plugin that analyzes container image sizes across Kubernetes clusters using node status data."
- Mention: No registry credentials required.

**2. Features**
- Bullet list of key features:
  - Analyze image sizes from node status (no registry credentials needed)
  - Histogram visualization of image size distribution
  - Filter by namespace and label selector
  - Table and JSON output formats
  - Top N images by size report
  - Performance metrics (query time, analysis time)
  - Color-coded output with `--no-color` option
  - Multi-cluster support via `--context`

**3. Installation**

Three methods:

*Via krew (recommended):*
```bash
kubectl krew install analyze-images
```

*From GitHub releases (manual):*
```bash
# Download the latest release for your platform
# Linux amd64
curl -LO https://github.com/ronaknnathani/kubectl-analyze-images/releases/latest/download/kubectl-analyze-images_$(uname -s | tr '[:upper:]' '[:lower:]')_$(uname -m | sed 's/x86_64/amd64/').tar.gz
tar xzf kubectl-analyze-images_*.tar.gz
sudo mv kubectl-analyze-images /usr/local/bin/
```

*From source:*
```bash
git clone https://github.com/ronaknnathani/kubectl-analyze-images.git
cd kubectl-analyze-images
make build
make install
```

**4. Usage**

Show the basic command and then specific examples:
```bash
# Analyze all images in the cluster
kubectl analyze-images

# Analyze images in a specific namespace
kubectl analyze-images --namespace=production

# Filter by label selector
kubectl analyze-images --namespace=production --selector="app=web"

# JSON output for scripting
kubectl analyze-images --output=json

# Use a specific kubectl context
kubectl analyze-images --context=prod-cluster

# Show top 50 images (default is 25)
kubectl analyze-images --top-images=50

# Disable colored output
kubectl analyze-images --no-color
```

**5. Flags Reference**

A table with ALL flags from main.go:
| Flag | Short | Default | Description |
| `--namespace` | `-n` | (all) | Target namespace |
| `--selector` | `-l` | | Label selector for pods |
| `--output` | `-o` | `table` | Output format: table, json |
| `--context` | | (current) | Kubernetes context to use |
| `--no-color` | | `false` | Disable colored output |
| `--top-images` | | `25` | Number of top images to show |
| `--version` | | | Show version information |

**6. Example Output**

Include the example output from the current README (the histogram and table example). Keep it realistic -- the current README already has good example output, preserve that.

**7. How It Works**

Brief explanation (keep from existing README):
- Default mode: queries all nodes for `node.Status.Images`
- Filtered mode: queries pods first, then cross-references with node status
- Uses Kubernetes pagination for large clusters
- Read-only: only needs GET access to pods and nodes

**8. Requirements**
- Kubernetes cluster v1.29+
- kubectl configured with cluster access
- RBAC: read access to pods and nodes (list, get)

**9. Development**

Subsections:
- Prerequisites: Go 1.23+, golangci-lint
- Build: `make build`
- Test: `make test`
- Lint: `make lint`
- All checks: `make check`
- Snapshot release: `make snapshot`
- See CONTRIBUTING.md for full guidelines

**10. Releasing (for maintainers)**

Step-by-step instructions (do NOT actually perform these):
```bash
# 1. Ensure all tests pass
make check

# 2. Tag the release
git tag -a v1.0.0 -m "Release v1.0.0"
git push origin v1.0.0

# 3. GoReleaser builds and publishes via GitHub Actions
# 4. Update krew manifest sha256 hashes from release checksums.txt
# 5. Test local krew install
kubectl krew install --manifest=plugins/analyze-images.yaml
# 6. Submit PR to krew-index
```

**11. License**
- "Licensed under the Apache License, Version 2.0. See [LICENSE](LICENSE) for details."

**12. Contributing**
- "Contributions welcome! See [CONTRIBUTING.md](CONTRIBUTING.md) for guidelines."

**IMPORTANT formatting notes:**
- Use clean markdown with proper heading hierarchy (h1 for title, h2 for sections, h3 for subsections)
- Keep code blocks with language hints (bash, yaml)
- No emojis
- No badges that require external services
- Keep it practical and concise -- this is a CLI tool README, not a framework
  </action>
  <verify>
  Run these checks:
  - `grep -q "krew install analyze-images" README.md` -- krew installation documented
  - `grep -q "github.com/ronaknnathani/kubectl-analyze-images" README.md` -- correct repo URL
  - `grep -q "\-\-namespace" README.md` -- flags documented
  - `grep -q "\-\-selector" README.md` -- flags documented
  - `grep -q "\-\-output" README.md` -- flags documented
  - `grep -q "\-\-context" README.md` -- flags documented
  - `grep -q "\-\-no-color" README.md` -- flags documented
  - `grep -q "\-\-top-images" README.md` -- flags documented
  - `grep -q "Apache" README.md` -- license referenced
  - `grep -q "CONTRIBUTING" README.md` -- contributing referenced
  - `wc -l README.md | awk '{print $1}'` -- at least 150 lines
  </verify>
  <done>
  README.md is a complete, polished document with: krew installation instructions, manual installation, source build, usage examples for all flags, flags reference table, example output, how-it-works explanation, development setup, release instructions for maintainers, and license/contributing links. Minimum 150 lines. Ready for v1.0.0 public release.
  </done>
</task>

</tasks>

<verification>
Final checks:
1. `wc -l README.md` -- at least 150 lines of comprehensive documentation
2. All six CLI flags documented in both usage examples and flags reference table
3. Three installation methods present: krew, GitHub releases, from source
4. Release instructions present but clearly marked as maintainer steps (not automated)
5. Links to LICENSE and CONTRIBUTING.md present
6. No broken markdown formatting (proper heading hierarchy, code blocks closed)
</verification>

<success_criteria>
- README has krew installation instructions (`kubectl krew install analyze-images`)
- README has manual binary installation from GitHub releases
- README has from-source build instructions using Makefile
- All 6 CLI flags documented with defaults and descriptions
- Example output showing histogram and table included
- Development section references actual Makefile targets
- Release instructions explain tag -> goreleaser -> krew manifest update flow
- LICENSE and CONTRIBUTING.md referenced with links
- At least 150 lines of well-structured markdown
</success_criteria>

<output>
After completion, create `.planning/phases/05-krew-distribution/05-02-SUMMARY.md`
</output>
